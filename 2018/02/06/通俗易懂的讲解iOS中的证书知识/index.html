<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 通俗易懂的讲解iOS中的证书知识 · qiuyu's Blog</title><meta name="description" content="通俗易懂的讲解iOS中的证书知识 - wang-qiuyu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="qiuyu's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/u/5578212666" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/wang-qiuyu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="https://www.jianshu.com/u/fd067b9ce42f" target="_blank" class="nav-list-link">简书</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">通俗易懂的讲解iOS中的证书知识</h1><div class="post-info">Feb 6, 2018</div><div class="post-content"><h4 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h4><p>iOS应用以流畅和安全著称，其中的安全性主要依靠的就是苹果开发中使用的一套证书流程。证书是用来给应用程序签名的，只有经过签名的应用程序才能保证他的来源是可信任的，并且代码是完整的，未经修改的。证书初次使用会感觉流程很复杂，其实对于流程理解了就会觉得简单了。</p>
<h4 id="模拟流程"><a href="#模拟流程" class="headerlink" title="模拟流程"></a>模拟流程</h4><p>在讲解之前，我先用现实中的一件事做个比方，这样理解起来简单一点。比如：我要成立一个汽车厂。</p>
<ol>
<li>按照规定，我要先拿到经营许可证，然后拿着经营许可证去政府的车辆审批部门去申请制造汽车的资质证明书，而车辆审批部门会给我发俩个资质证明书，一个搞内部研发的资质证明书，一个可以投入市场的资质证明书，都是只有一年期限。</li>
<li>拿到资质证明书后，才可以开始汽车制造。首先我还必须要注册一个商标，这个商标要登记在车辆审批部门，防止别人伪造。</li>
<li>然后我拿着研发资质证明书，就可以进行研发了，经过科(加)学(班)规(加)范(点)的研发，车子终于成型，我想投入市场，但是为了安全，最好经过测试合格后才可以。</li>
<li>这时候我可以进行内部测试，审批部门每年会给我100个名额，我可以最多找100个人测试，这一百个人不必非要在授权的门店里买车，可以直接试车。需要注意的是，我在进行内部试车的时候，也分俩种情况，一种是在我自己规划的场地进行试车，另一种就是在外面的正常的公路上进行试车，但都是在没有检验合格证的情况下试车的。</li>
<li>试过之后，我就可以拿着投入市场的资质证明书给车检部门发出申请，然后他们要对我的车子进行检验审核，没有问题了，给我一个检验合格证，我就可以正式投入市场了。</li>
<li>投入市场后，来买车的人会看到我的资质证明书和我注册的商标以及检验合格证就可以确定这是正品，就可以放心来买了。</li>
<li>如果我想在车上安装导航系统，同样的也要申请俩个证书，一个开发导航资质证明书，一个发布导航资质证明书，同样是需要和商标绑在一起，一年期限。当然我也可以委托第三方厂家给我开发，只要我提供俩个资质证明书即可。</li>
</ol>
<h4 id="实际开发流程"><a href="#实际开发流程" class="headerlink" title="实际开发流程"></a>实际开发流程</h4><p>接下来，就回到iOS中的开发流程中来。</p>
<ol>
<li>首先我需要一个开发者账号，分为个人账号(Individual) 和 公司团队账号(Company/Organization)和企业账号(Enterprise)三种类型，个人和公司团队都是99美元一年，可以发布到AppStore上，每年可以有100个苹果的iOS设备测试。企业账号是299美元一年，但是不能发布到App Store，只能企业内部应用，苹果的iOS设备数量不限制。就好比我生产的车不能发布到市场上，只能在自己的地盘上试验，一旦上路就是黑车了，被检查到会被吊销营业资格。</li>
<li>有了账号，就可以申请经营许可证了，也就是通过Keychain（钥匙串）的证书助理从证书颁发机构请求证书。<br><img src="http://upload-images.jianshu.io/upload_images/299599-089b78b5280e2f27.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="455017-e84ef019ef4984b2.png"><br>结果keychain 将生成一个包含开发者身份信息和公钥的CSR（Certificate Signing Request）文件。私钥 private key始终保存在 Mac OS 的 Keychain Access 中，用于签名（CodeSign）本机对外发布的 App；公钥 public key 一般随证书散布出去，对 App 签名进行校验认证。用户必须妥善保存本地 Keychain 中的 private key，以防伪冒。<br><img src="http://upload-images.jianshu.io/upload_images/299599-cb79df190f0a3f62.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20150114091003101.jpg"></li>
<li>使用CSR文件到开发者中心申请证书。首先要了解几个概念，Certificates(证书)，Identifiers(标识符)，Devices(设备)，Provisioning Profiles(描述文件)。页面如图所示：<br><img src="http://upload-images.jianshu.io/upload_images/299599-233c2868686954a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160808_2.png">Certificates(证书)就是到车辆审批部门去申请的资质证明书，Identifiers(标识符)就是车的商标，Devices(设备)就是可以试车的那100个人，Provisioning Profiles(描述文件)就是包含了证书，标识符和设备的文件，也就是客户试车的时候的凭证。申请证书页面如图：<br><img src="http://upload-images.jianshu.io/upload_images/299599-a160111148c136ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="455017-7acbae0d954a0580.png">其中，Development就是开发证书，Production是发布证书，细分起来，发布证书分为AppStore发布证书和Ad Hoc发布证书，AppStore证书就是提交审核时用到的证书，也就类似于投入市场的资质证明书，Ad Hoc证书可以模拟生产环境，类似于在外面的正常的公路上试车那种类型。最后生成成功后download下来并双击导入钥匙串。<img src="http://upload-images.jianshu.io/upload_images/299599-7c70d3dcd09367bf.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20150114091440719.jpg">在多台机器上共享证书，在 Keychain Access|Certificates 中选中欲导出的 certificate 或其下 private key，右键 Export导出p12文件，其他 Mac 机器上双击 Certificates.p12（如有密码需输入密码）即可安装该共享证书。</li>
<li>接下来去申请一个App ID，也就是去申请一个汽车商标。在“ Identifiers”一栏下选择“App IDs”，可查看所有已申请的App IDs,点击右上“＋”，需要注意，App ID一般是反域名格式，如：com.company.test。在“App Services”栏下选择应用使用到的服务（如要使用推送功能，勾选“Push Notifications”）。</li>
<li>添加调试设备，也就是可以试车的人员，使用UDID来标识每一台设备都有唯一性，注意，一年只有100个名额，即使删除掉也算用去了一个名额。</li>
<li>添加描述文件（Provisioning Profile），描述文件和证书的环境相对应。描述文件就类似于售车时，给客户列出的一系列合法文件证明。<br><img src="http://upload-images.jianshu.io/upload_images/299599-c05c3e708d9f3cda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160808_3.png"><blockquote>
<p>1.Provisioning Profile决定Xcode用哪个证书（公钥）/私钥组合（Key Pair/Signing Identity）来签名应用程序（Signing Product）,将在应用程序打包时嵌入到.ipa包里。<br>2.Provisioning Profile把这些信息全部打包在一起，方便我们在调试和发布程序打包时使用。这样，只要在不同的情况下选择不同的Provisioning Profile文件就可以了。<br>3.Provisioning Profile也分为Development和Distribution两类，有效期同Certificate一样。Development版本的ProvisioningProfile用于开发调试，Distribution版本的ProvisioningProfile主要用于提交App Store审核，其不指定开发测试的Devices。<br>4.Xcode 将全部供应配置文件（包括用户手动下载安装的和 Xcode 自动创建的Provisioning Profile放在目录 [~/Library/MobileDevice/Provisioning Profiles] 下。</p>
</blockquote>
</li>
</ol>
<p>生成成功后的Provisioning Profile下载到本地，双击会自动安装到xcode中。<br>7.最后，如果需要开通推送功能，还需要再申请俩个推送证书，流程同开发证书一样。也可以使用第三方推送平台，但是得提供俩个环境的推送证书。<br><img src="http://upload-images.jianshu.io/upload_images/299599-99501c16357bb56d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160808_5.png"></p>
<p>一切准备完毕，这时候就可以打包提交到AppStore进行审核了，类似于车检部门进行审核，审核通过后发到AppStore市场上，就类似于拿到了检验合格证了。</p>
<hr>
<p>iOS开发中的证书使用的流程就是这样了，希望本文能帮助到你更好的理解iOS开发。</p>
<p>参考：<br> <a href="http://blog.csdn.net/phunxm/article/details/42685597" target="_blank" rel="noopener">iOS Provisioning Profile(Certificate)与Code Signing详解</a><br> <a href="http://www.cnblogs.com/taintain1984/archive/2013/03/16/2963478.html" target="_blank" rel="noopener">苹果IOS开发者账号总结</a><br> <a href="http://www.jianshu.com/p/9d9e3699515e" target="_blank" rel="noopener">iOS开发证书与配置文件的使用</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/02/06/iOS圆球沿着椭圆轨迹做动画/" class="prev">上一篇</a><a href="/2018/02/06/iTunes-Connect-Simplified-screenshot-submission-process/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://yoursite.com">wang-qiuyu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>